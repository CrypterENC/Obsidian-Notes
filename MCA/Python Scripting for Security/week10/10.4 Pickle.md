# Pickle in Python

## Overview
- `pickle` module serializes/deserializes Python objects.
- Converts objects to byte stream for storage or transmission.
- Can handle complex objects like lists, dicts, classes.

## Pickling (Saving)
```python
import pickle

data = {'name': 'Alice', 'age': 30}
with open('data.pkl', 'wb') as f:
    pickle.dump(data, f)
```

## Unpickling (Loading)
```python
with open('data.pkl', 'rb') as f:
    loaded_data = pickle.load(f)
print(loaded_data)  # {'name': 'Alice', 'age': 30}
```

## Protocols
- `pickle.HIGHEST_PROTOCOL`: Latest, most efficient.
- Default protocol: 4 (Python 3.8+).

## Example with Class
```python
class Person:
    def __init__(self, name, age):
        self.name = name
        self.age = age

p = Person('Bob', 25)
with open('person.pkl', 'wb') as f:
    pickle.dump(p, f)

with open('person.pkl', 'rb') as f:
    loaded_p = pickle.load(f)
```

## Warnings
- **Security Risk**: Never unpickle data from untrusted sources (can execute arbitrary code).
- **Python Version Compatibility**: Pickled objects may not work across Python versions.
- **Not Human-Readable**: Use JSON for readable formats.
- **Alternatives**: Use `json` for simple data, `shelve` for persistent storage.

## More Examples

### Pickling Multiple Objects
```python
import pickle

data1 = [1, 2, 3]
data2 = {'key': 'value'}

with open('multi.pkl', 'wb') as f:
    pickle.dump(data1, f)
    pickle.dump(data2, f)

with open('multi.pkl', 'rb') as f:
    loaded1 = pickle.load(f)
    loaded2 = pickle.load(f)

print(loaded1, loaded2)  # [1, 2, 3] {'key': 'value'}
```

### In-Memory Serialization (dumps/loads)
```python
import pickle

data = {'a': 1, 'b': [2, 3, 4]}

# Serialize to bytes
pickled_bytes = pickle.dumps(data)

# Deserialize from bytes
unpickled_data = pickle.loads(pickled_bytes)

print(unpickled_data)  # {'a': 1, 'b': [2, 3, 4]}
```

### Pickling Custom Objects with Methods
```python
import pickle

class Calculator:
    def __init__(self, value):
        self.value = value
    
    def add(self, num):
        self.value += num
        return self.value

calc = Calculator(10)
calc.add(5)

# Pickle the object
with open('calc.pkl', 'wb') as f:
    pickle.dump(calc, f)

# Unpickle and use
with open('calc.pkl', 'rb') as f:
    loaded_calc = pickle.load(f)

print(loaded_calc.value)  # 15
loaded_calc.add(3)
print(loaded_calc.value)  # 18
```

### Handling Exceptions
```python
import pickle

try:
    with open('nonexistent.pkl', 'rb') as f:
        data = pickle.load(f)
except FileNotFoundError:
    print("File not found!")
except pickle.UnpicklingError:
    print("Error unpickling data!")
```